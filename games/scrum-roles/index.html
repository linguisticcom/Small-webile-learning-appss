<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu des Rôles et Responsabilités de Scrum</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-bg: #f4f7f9;
            --color-card: #ffffff;
            --color-text: #333;
            --color-po: #007acc;
            --color-sm: #f2a900;
            --color-dev: #6b5b95;
            --color-all: #4caf50;
            --color-correct: #28a745;
            --color-incorrect: #dc3545;
            --color-hint: #17a2b8;
            --border-primary: 2px solid #555;
            --border-secondary: 2px dashed #999;
            --shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        #app-container {
            max-width: 1400px;
            margin: auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
        }

        /* Style for the new logo */
        header img.logo {
            max-height: 80px;
            margin-bottom: 20px;
        }

        header h1 {
            font-size: 2.5em;
            color: var(--color-text);
            margin: 0;
        }

        header p {
            font-size: 1.1em;
            color: #666;
            max-width: 800px;
            margin: 10px auto 0;
        }
        
        #game-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin-top: 20px;
            padding: 10px;
            background: var(--color-card);
            border-radius: 8px;
            box-shadow: var(--shadow);
            max-width: 400px;
            margin: 20px auto 0;
        }
        
        #score-container {
            font-size: 1.5em;
            font-weight: bold;
        }
        
        #score-value {
            display: inline-block;
            min-width: 50px;
            text-align: center;
            padding: 2px 8px;
            border-radius: 5px;
            background: #e9ecef;
            transition: transform 0.2s ease-in-out;
        }
        
        #score-value.changed {
            transform: scale(1.2);
        }

        #controls {
            text-align: center;
            margin-bottom: 30px;
        }

        #controls button {
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            margin: 5px;
        }
        
        #show-answers-button { background-color: var(--color-po); }
        #show-answers-button:hover { background-color: #005f9e; }
        #reset-button { background-color: #6c757d; }
        #reset-button:hover { background-color: #5a6268; }

        main {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        #card-pool-container {
            flex: 1;
            min-width: 280px;
            background-color: #e9ecef;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }
        
        #card-pool-container h2 {
            text-align: center;
            margin-top: 0;
            color: #495057;
        }

        #card-pool {
            flex-grow: 1;
            padding: 10px;
            min-height: 200px;
            border: 2px dashed #adb5bd;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            transition: background-color 0.3s;
        }

        #role-columns {
            flex: 3;
            display: grid;
            /* Changed to always display 4 columns on the same row */
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .role-column {
            background-color: var(--color-card);
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            padding: 15px;
        }

        .role-column h3 {
            text-align: center;
            margin: 0 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid;
            font-size: 1.2em;
        }
        
        #po-column h3 { border-color: var(--color-po); color: var(--color-po); }
        #sm-column h3 { border-color: var(--color-sm); color: var(--color-sm); }
        #dev-column h3 { border-color: var(--color-dev); color: var(--color-dev); }
        #all-column h3 { border-color: var(--color-all); color: var(--color-all); }

        .drop-zone {
            flex-grow: 1;
            min-height: 150px;
            border-radius: 5px;
            padding: 10px;
            transition: background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .drop-zone.drag-over {
            background-color: #e7f3ff;
            border: 2px dashed var(--color-po);
        }

        .card {
            background-color: var(--color-card);
            padding: 12px 28px 12px 12px;
            border-radius: 5px;
            cursor: grab;
            user-select: none;
            font-size: 0.95em;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.4s;
            position: relative;
        }

        .card.primary { border: var(--border-primary); }
        .card.secondary { border: var(--border-secondary); }

        .card.dragging {
            opacity: 0.5;
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        
        .card.correct { border-left: 5px solid var(--color-correct); background-color: #e9f7ef; }
        .card.incorrect { border-left: 5px solid var(--color-incorrect); background-color: #fce8e6; }

        .hint-button {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background-color: var(--color-hint);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
            transition: background-color 0.2s, transform 0.2s;
        }
        .hint-button:hover { background-color: #138496; transform: scale(1.1); }
        .hint-button.used { background-color: #6c757d; cursor: not-allowed; }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px 30px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            animation: slideIn 0.4s;
        }
        .close-button {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close-button:hover, .close-button:focus { color: black; }
        .modal-content h3 { color: var(--color-hint); }

        /* Style for the new footer */
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #777;
        }

        footer a {
            color: var(--color-po);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    </style>
</head>
<body>

    <div id="app-container">
        <header>
            <!-- Added logo -->
            <img src="assets/LOGO.jpg" alt="Logo" class="logo" onerror="this.onerror=null;this.src='https://placehold.co/200x80/007acc/FFFFFF?text=Your+Logo';">
            <h1>Jeu des Rôles et Responsabilités de Scrum</h1>
            <p>Faites glisser chaque carte pour l'associer à un rôle. Un bon placement rapporte 10 points, une erreur en coûte 5. Besoin d'aide ? Cliquez sur le bouton '?' pour un indice (-3 points).</p>
            <div id="game-info">
                <div id="score-container">Score : <span id="score-value">0</span></div>
                <div id="controls">
                    <button id="show-answers-button">Réponses</button>
                    <button id="reset-button">Réinitialiser</button>
                </div>
            </div>
        </header>

        <main>
            <div id="card-pool-container">
                <h2>Deck des Responsabilités</h2>
                <div id="card-pool" class="drop-zone" data-role="pool"></div>
            </div>

            <div id="role-columns">
                <div class="role-column" id="po-column"><h3>Product Owner</h3><div class="drop-zone" data-role="po"></div></div>
                <div class="role-column" id="sm-column"><h3>Scrum Master</h3><div class="drop-zone" data-role="sm"></div></div>
                <div class="role-column" id="dev-column"><h3>Developers</h3><div class="drop-zone" data-role="dev"></div></div>
                <div class="role-column" id="all-column"><h3>Équipe Scrum (Tous)</h3><div class="drop-zone" data-role="all"></div></div>
            </div>
        </main>

        <!-- Added footer with the link -->
        <footer>
            <p>
                For more games, click here: 
                <a href="https://linguistic-communication.com/course-category/new-courses/" target="_blank" rel="noopener noreferrer">
                    https://linguistic-communication.com/course-category/new-courses/
                </a>
            </p>
        </footer>
    </div>

    <!-- Hint Modal -->
    <div id="hint-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">×</span>
            <h3>Indice</h3>
            <p id="hint-text"></p>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DATA ---
        const responsibilities = [
            // Product Owner
            { text: "Prioriser le Product Backlog", type: "primary", role: "po", hint: "Qui est le seul responsable de la valeur métier et du retour sur investissement (ROI) ?" },
            { text: "Échanger avec les parties-prenantes", type: "primary", role: "po", hint: "Qui représente la voix du client et des utilisateurs ?" },
            { text: "Rendre le Product Backlog visible de tous", type: "primary", role: "po", hint: "Qui s'assure que tout le monde sait sur quoi l'équipe va travailler ensuite ?" },
            { text: "Suivre la progression de la release", type: "primary", role: "po", hint: "Qui doit savoir si l'on est en bonne voie pour livrer un ensemble de fonctionnalités à une date donnée ?" },
            { text: "Valider la production", type: "primary", role: "po", hint: "Qui a le dernier mot pour dire si une fonctionnalité répond bien au besoin initialement demandé ?" },
            { text: "Saisir des éléments dans le Product Backlog", type: "primary", role: "po", hint: "Bien que d'autres puissent aider, qui est ultimement responsable du contenu du backlog ?" },
            { text: "Conception produit", type: "primary", role: "po", hint: "Qui est responsable de la vision globale et de la conception fonctionnelle du produit pour répondre aux besoins du marché ?" },
            { text: "Garantir la qualité", type: "secondary", role: "po", hint: "En définissant des critères d'acceptation clairs, ce rôle contribue indirectement à la qualité." },

            // Scrum Master
            { text: "Régler les problèmes organisationnels", type: "primary", role: "sm", hint: "Qui est le 'dissolvant d'obstacles' pour l'équipe, surtout ceux qui dépassent son cadre ?" },
            { text: "Faciliter les événements Scrum", type: "primary", role: "sm", hint: "Qui s'assure que les réunions (planning, mêlée, revue, etc.) sont productives et respectent leur timebox ?" },
            { text: "Garantir que les règles de Scrum sont suivies", type: "primary", role: "sm", hint: "Qui est le gardien du framework Scrum ?" },
            { text: "Coacher l'équipe", type: "primary", role: "sm", hint: "Qui aide l'équipe à s'améliorer en continu et à devenir plus autonome ?" },
            { text: "Améliorer les processus", type: "primary", role: "sm", hint: "Qui guide l'équipe et l'organisation dans l'adoption de meilleures pratiques agiles ?" },
            { text: "Garantir la qualité", type: "secondary", role: "sm", hint: "En s'assurant que la 'Definition of Done' est respectée, ce rôle aide à maintenir un haut standard." },

            // Developers
            { text: "Garantir la qualité", type: "primary", role: "dev", hint: "Qui construit l'incrément et doit donc s'assurer qu'il respecte la 'Definition of Done' ?" },
            { text: "Conception logicielle architecturale", type: "primary", role: "dev", hint: "Qui est responsable de définir la structure technique et les choix d'architecture pour construire le produit ?" },
            { text: "Réalisation", type: "primary", role: "dev", hint: "Qui écrit le code ?" },
            { text: "Test (unitaire)", type: "primary", role: "dev", hint: "Qui est responsable de la qualité technique du code qu'il produit ?" },
            { text: "Intégration logicielle", type: "primary", role: "dev", hint: "Qui s'assure que les différentes parties du code fonctionnent bien ensemble ?" },
            { text: "Déploiement", type: "primary", role: "dev", hint: "Qui est responsable de la mise en production de l'incrément ?" },
            { text: "Régler les problèmes techniques", type: "primary", role: "dev", hint: "Quand un bug ou un problème de performance apparaît, qui est en première ligne pour le résoudre ?" },
            { text: "Améliorer les pratiques techniques", type: "primary", role: "dev", hint: "Qui est le plus à même de proposer et d'adopter des outils et des techniques comme le TDD ou l'intégration continue ?" },
            { text: "Suivre la progression du Sprint", type: "primary", role: "dev", hint: "Qui met à jour le burndown chart du sprint et sait si l'objectif de sprint est en danger ?" },
            { text: "Participer au standup quotidien", type: "primary", role: "dev", hint: "Cet événement est pour les Developers. Le Product Owner y participe souvent pour répondre aux questions et rester synchronisé." },
            
            // Whole Scrum Team
            { text: "Participer au Sprint Planning", type: "primary", role: "all", hint: "Quelle réunion nécessite la collaboration de tous pour définir l'objectif de Sprint et sélectionner les éléments du backlog ?" },
            { text: "Participer à la revue de Sprint", type: "primary", role: "all", hint: "Lors de quel événement toute l'équipe présente ce qui a été accompli et recueille des feedbacks ?" },
            { text: "Participer à la rétrospective de Sprint", type: "primary", role: "all", hint: "Quelle cérémonie est dédiée à l'inspection et l'adaptation des processus de l'équipe entière ?" },
            { text: "Participer au Backlog Grooming", type: "primary", role: "all", hint: "Quel atelier de préparation du backlog bénéficie de la perspective de toute l'équipe (estimation, clarification) ?" },
            { text: "Améliorer les processus", type: "secondary", role: "all", hint: "Même si un rôle guide cette activité, qui est collectivement responsable de s'améliorer ?" }
        ];

        // --- STATE ---
        let score = 0;
        let draggedCard = null;

        // --- DOM ELEMENTS ---
        const cardPool = document.getElementById('card-pool');
        const dropZones = document.querySelectorAll('.drop-zone');
        const scoreElement = document.getElementById('score-value');
        const hintModal = document.getElementById('hint-modal');
        const hintTextElement = document.getElementById('hint-text');
        const closeModalButton = document.querySelector('.close-button');

        // --- FUNCTIONS ---
        function updateScore(points) {
            score += points;
            scoreElement.textContent = score;
            // Visual feedback for score change
            scoreElement.classList.add('changed');
            setTimeout(() => scoreElement.classList.remove('changed'), 200);
        }
        
        function initializeGame() {
            score = 0;
            updateScore(0);
            cardPool.innerHTML = '';
            document.querySelectorAll('.role-column .drop-zone').forEach(dz => dz.innerHTML = '');
            
            responsibilities
                .map(value => ({ value, sort: Math.random() }))
                .sort((a, b) => a.sort - b.sort)
                .map(({ value }) => value)
                .forEach((resp, index) => {
                    const card = document.createElement('div');
                    card.id = `card-${index}`;
                    card.className = `card ${resp.type}`;
                    card.draggable = true;
                    card.textContent = resp.text;
                    card.dataset.role = resp.role;
                    card.dataset.hint = resp.hint;
                    card.dataset.status = 'unplaced'; // unplaced, correct, incorrect

                    const hintButton = document.createElement('button');
                    hintButton.className = 'hint-button';
                    hintButton.innerHTML = '?';
                    hintButton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showHint(card);
                    });
                    
                    card.appendChild(hintButton);
                    cardPool.appendChild(card);
                });
            
            addDragListeners();
        }

        function addDragListeners() {
            document.querySelectorAll('.card').forEach(card => {
                card.addEventListener('dragstart', dragStart);
                card.addEventListener('dragend', dragEnd);
            });
        }
        
        function showHint(card) {
            const hintButton = card.querySelector('.hint-button');
            if (hintButton.classList.contains('used')) return;

            hintTextElement.textContent = card.dataset.hint;
            hintModal.style.display = 'block';
            
            updateScore(-3);
            hintButton.classList.add('used');
        }

        // --- DRAG & DROP EVENT HANDLERS ---
        function dragStart() {
            draggedCard = this;
            setTimeout(() => this.classList.add('dragging'), 0);
        }

        function dragEnd() {
            this.classList.remove('dragging');
            draggedCard = null;
        }

        function dragOver(e) {
            e.preventDefault();
            this.classList.add('drag-over');
        }
        
        function dragLeave() {
            this.classList.remove('drag-over');
        }

        function drop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            if (!draggedCard || this.contains(draggedCard)) return;

            const previousStatus = draggedCard.dataset.status;
            
            this.appendChild(draggedCard);
            
            const dropZoneRole = this.dataset.role;
            const cardRole = draggedCard.dataset.role;
            const isCorrect = dropZoneRole === cardRole;
            const newStatus = (dropZoneRole === 'pool') ? 'unplaced' : (isCorrect ? 'correct' : 'incorrect');

            // Only update score if status changes
            if (newStatus !== previousStatus) {
                // Reverting a placement
                if (previousStatus === 'correct') updateScore(-10);
                if (previousStatus === 'incorrect') updateScore(5);
                
                // Making a new placement
                if (newStatus === 'correct') updateScore(10);
                if (newStatus === 'incorrect') updateScore(-5);
            }

            draggedCard.dataset.status = newStatus;
            draggedCard.classList.remove('correct', 'incorrect');
            if (newStatus === 'correct' || newStatus === 'incorrect') {
                 draggedCard.classList.add(newStatus);
            }
        }

        // --- EVENT LISTENERS ---
        dropZones.forEach(zone => {
            zone.addEventListener('dragover', dragOver);
            zone.addEventListener('dragleave', dragLeave);
            zone.addEventListener('drop', drop);
        });

        document.getElementById('reset-button').addEventListener('click', initializeGame);
        
        document.getElementById('show-answers-button').addEventListener('click', () => {
            document.querySelectorAll('.card').forEach(card => {
                const correctRole = card.dataset.role;
                const correctZone = document.querySelector(`.drop-zone[data-role="${correctRole}"]`);
                if (correctZone && card.parentElement !== correctZone) {
                    correctZone.appendChild(card);
                    card.classList.remove('incorrect');
                    card.classList.add('correct');
                    card.dataset.status = 'correct';
                }
            });
            // Note: Showing answers doesn't affect the score to avoid abuse.
        });

        closeModalButton.addEventListener('click', () => hintModal.style.display = 'none');
        window.addEventListener('click', (event) => {
            if (event.target === hintModal) {
                hintModal.style.display = 'none';
            }
        });

        // --- INITIALIZATION ---
        initializeGame();
    });
    </script>
</body>
</html>
